import os
import pandas as pd

import plotly.express as px
import plotly.io as pio
pio.renderers.default = 'browser'

os.chdir(r"D:\GitHub\dilemma_zone_modeling")

# initialize dictionary and add coordinates of gates for different nodes
gates = {}

gates[216] = {'WB': {'g1': {'c1': [32.23623387183563, -110.95704612062104], 'c2': [32.23584444480096, -110.95801491770929]}, 
                   'g2': {'c1': [32.236194531035, -110.9590193063268], 'c2': [32.23585317494202, -110.96002668109561]}, 
                   'g3': {'c1': [32.236182941639164, -110.9601027758238], 'c2': [32.235851944322604, -110.96074248449695]}},
            
            'EB': {'g1': {'c1': [32.23584382160089, -110.96195953329713], 'c2': [32.23611415823616, -110.96098500863695]}, 
                   'g2': {'c1': [32.236194531035, -110.9590193063268], 'c2': [32.23585317494202, -110.96002668109561]}, 
                   'g3': {'c1': [32.23586397417719, -110.95893963052627], 'c2': [32.236197800118596, -110.95790914749665]}},
            
            'SB': {'g1': {'c1': [32.23813965478527, -110.95965146123845], 'c2': [32.23729701875391, -110.95936528795538]}, 
                   'g2': {'c1': [32.23649518155123, -110.95966470512946], 'c2': [32.23554916800589, -110.95938346915386]}, 
                   'g3': {'c1': [32.23551573217044, -110.95962477408324], 'c2': [32.23470528666917, -110.95939205181755]}}}

gates[217] = {'WB': {'g1': {'c1': [32.23622441367268, -110.94077579459487], 'c2': [32.2359004908651, -110.94174098710045]}, 
                   'g2': {'c1': [32.23628919434819, -110.94337197947992], 'c2': [32.23587130034809, -110.94457990578354]}, 
                   'g3': {'c1': [32.23627228383154, -110.94463102873335], 'c2': [32.23588925357068, -110.94554792116436]}},
            
            'EB': {'g1': {'c1': [32.23581974767533, -110.94717228344238], 'c2': [32.236246638611604, -110.9462029266629]}, 
                   'g2': {'c1': [32.23628919434819, -110.94337197947992], 'c2': [32.23587130034809, -110.94457990578354]}, 
                   'g3': {'c1': [32.23587776483134, -110.9433246954967], 'c2': [32.23624022236206, -110.94237623246346]}},
            
            'SB': {'g1': {'c1': [32.23879055073666, -110.94420072284095], 'c2': [32.23795059486595, -110.9437898174783]}, 
                   'g2': {'c1': [32.23657376304689, -110.94425290702216], 'c2': [32.23557578326345, -110.94369410495075]}, 
                   'g3': {'c1': [32.23556392170348, -110.94424646636583], 'c2': [32.23475532073333, -110.94377401346846]}},
            
            'NB': {'g1': {'c1': [32.233375669862845, -110.94380393857026], 'c2': [32.23420822807635, -110.94415003582566]}, 
                   'g2': {'c1': [32.23657376304689, -110.94425290702216], 'c2': [32.23557578326345, -110.94369410495075]}, 
                   'g3': {'c1': [32.23658657907745, -110.9437471960456], 'c2': [32.23741786976938, -110.94422783515239]}}}

gates[517] = {'WB': {'g1': {'c1': [32.2357646319026, -110.838397847857], 'c2': [32.235378905996136, -110.8393949663534]}, 
                   'g2': {'c1': [32.235772059425365, -110.84033373144005], 'c2': [32.235381694499964, -110.84169364018913]}, 
                   'g3': {'c1': [32.23575786741197, -110.84177081218584], 'c2': [32.23537617658705, -110.84267193876724]}},
            
            'EB': {'g1': {'c1': [32.235388375049126, -110.84364033355443], 'c2': [32.23576569139845, -110.84270693453031]}, 
                   'g2': {'c1': [32.235772059425365, -110.84033373144005], 'c2': [32.235381694499964, -110.84169364018913]},
                   'g3': {'c1': [32.235377996758025, -110.84030285113664], 'c2': [32.235790667351715, -110.83935384574929]}},
            
            'SB': {'g1': {'c1': [32.2377869592791, -110.84122097555806], 'c2': [32.236971610248325, -110.84083525936194]}, 
                   'g2': {'c1': [32.236141191766954, -110.84125572646832], 'c2': [32.23500382730076, -110.84077393174813]}, 
                   'g3': {'c1': [32.23496592898976, -110.8412598217959], 'c2': [32.23417893028391, -110.84076503014434]}},
            
            'NB': {'g1': {'c1': [32.23336236363523, -110.84083514345475], 'c2': [32.234159547977804, -110.84122691338719]}, 
                   'g2': {'c1': [32.236141191766954, -110.84125572646832], 'c2': [32.23500382730076, -110.84077393174813]}, 
                   'g3': {'c1': [32.236189975631866, -110.84079435013008], 'c2': [32.23695978579779, -110.84122387084767]}}}

gates[618] = {'WB': {'g1': {'c1': [32.20665295707573, -110.83771363821641], 'c2': [32.20632703858727, -110.83870841881]}, 
                   'g2': {'c1': [32.20670243885439, -110.84031785475767], 'c2': [32.2063017961023, -110.84161822309939]}, 
                   'g3': {'c1': [32.206695829289856, -110.84171789417726], 'c2': [32.20632683492474, -110.84262793587901]}},
            
            'EB': {'g1': {'c1': [32.2063236517449, -110.84424204045985], 'c2': [32.206674966270896, -110.8432816042172]}, 
                   'g2': {'c1': [32.20670243885439, -110.84031785475767], 'c2': [32.2063017961023, -110.84161822309939]}, 
                   'g3': {'c1': [32.20631734722534, -110.84023622784471], 'c2': [32.20670242953868, -110.83933236008566]}},
            
            'SB': {'g1': {'c1': [32.20925586871524, -110.84115401045611], 'c2': [32.20842481202438, -110.84078692567395]}, 
                   'g2': {'c1': [32.20703449051995, -110.84122156347183], 'c2': [32.20596230326421, -110.840747374056]}, 
                   'g3': {'c1': [32.20592518738928, -110.84121511234675], 'c2': [32.20511865991968, -110.84080256547394]}},
            
            'NB': {'g1': {'c1': [32.20379899171929, -110.84080563004564], 'c2': [32.204588403734796, -110.84116570003016]}, 
                   'g2': {'c1': [32.20703449051995, -110.84122156347183], 'c2': [32.20596230326421, -110.840747374056]}, 
                   'g3': {'c1': [32.20708441639085, -110.84076317585287], 'c2': [32.20787755518876, -110.841236151704]}}}

# convert dictionary to df
def process_nested_dict(data):
    rows = []
    
    for node, node_val in data.items():
        for dirc, dirc_val in node_val.items():
            for gate, gate_val in dirc_val.items():
                for corner, coord in gate_val.items():
                    row = {
                        'node': node,
                        'approach': dirc,
                        'gate': gate,
                        'corner': corner,
                        'lat': coord[0],
                        'lon': coord[1]
                    }
                    rows.append(row)
                    
    return pd.DataFrame(rows)

df = process_nested_dict(gates)

# plot coordinates for each node
px.scatter(
    df,
    x = 'lon',
    y = 'lat',
    color = 'approach'
).update_traces(marker_size = 10).show()